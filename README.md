# 포즈인식을 이용한 넘어짐 감지 서비스   

    팀명 : KDK 
  
    결과물 브랜드명 : 넘어지지마요
  
  
# 프로젝트 개요

  넘어지는 것은 위험합니다. 특히 65세 이상 인구의 3분의 1이 1년에 한번 정도는 넘어지는 사고를 당한다고 합니다.
  
  노인들의 사망 사고가 넘어지는 데에서 시작되는 경우가 많습니다. 나이가 들수록 골절이나 뇌진탕 등을 회복하기 어려워지고 합병증 등으로 번지기 때문입니다. 하지만 넘어지는 사고들은 적절한 응급 조치가 뒤따르면 대체로 빠르게 회복할 수 있습니다.
  
  부상자가 정신을 잃었거나 적절한 통신수단에 접근할 수 없는 심각한 상태에서 직접 연락하기 힘들 것입니다.
  
  이러한 상황에서 '넘어지지마요'는 자동으로 비상 연락망에 연락을 취해 더 심각한 상황으로 가는것을 막아줍니다.
 

# 프로젝트 상세

- 카메라를 통해 사람의 포즈를 인식하는 방식으로 위험상황을 감별합니다.

- 카메라 센서를 이용해서 인물사진을 얻고 사진을 통해서 포즈인식 모델을 학습할 수 있습니다. 

- 인물사진이 없는 초기에는 MPII Human Pose Dataset을 이용하여 학습하고 COCO DataSet을 이용하여 평가합니다. 

- 포즈인식 모델이 급작스럽게 쓰러지거나 ,넘어지는 경우를 위험상황으로 인식하도록 학습시킵니다.

- 포즈 인식이 클라이언트에서 이루어지므로 어느정도 컴퓨팅 파워가 필요하므로, 데모에서는 안드로이드 핸드폰을 이용하거나, 라즈베리파이 4 모델 B + 라즈베리파이 카메라모듈 V2, 8MP를 사용할 계획입니다.

- 카메라가 작동하면서, 포즈 인식 데이터를 활용하여 신체 부위의 현재 위치를 측정한 후, 머리의 위치가 갑작스럽게 변하거나, 다리를 중심으로 회전하는 경우를 넘어짐, 쓰러짐으로 감지하여 서버에 알려주면 서버에서 비상연락망(라인 봇, 텔레그램 봇)(카카오톡 봇은 push api가 없어서 불가)에 연락하도록 하는 프로그램 구현합니다.

- 데이터 분석 및 학습은 오픈소스로 공개된 MobilePose-pytorch를 기반으로 인물사진을 이용한 포즈 인식을 학습하여 사용할 것입니다. 클라이언트에서 포즈가 인식된, 즉 인물이라고 판별된 것이 있는 사진을 보내서 1차 필터링하고, 서버에 모인 인물 사진들은 간단히 사진에 인물에 제대로 찍혀있는지를 수작업으로 필터링하여 학습 데이터로 사용합니다. 초기에는 인물사진이 부족하므로, 공개되어있는 데이터 셋을 가져와 사용합니다.

- 24시간 상시촬영으로 인한 사생활침해나 인권문제, 보안 문제는 추후 더 협의되어야 할 상황입니다.


# 예상 시스템 구성도
![cd1](https://user-images.githubusercontent.com/21076531/80339700-2e383c80-889a-11ea-8135-968f9980e00b.png)


# 기술 상세

- 아래 이미지같은 데이터를 보유한 COCO dataset과 MPII Human Pose Dataset을 활용하여 다양한 포즈들에 대한 machine learing을 할 계획입니다. Python을 이용할 계획이고, data pre-processing 후에 사람의 다양한 동작들을 분류하고, 그 중 저희가 관심있는 넘어지는 동작에 대해 더 많은 dataset을 학습시킬 계획입니다. 그 결과로 카메라로 인식될 동작에 대해 현재 사용자의 상태가 어떠한지를 판단하고 알릴 수 있게 하려고 합니다. 또한 어플을 사용하면서 추가될 수 있는 넘어지는 동작들을 추가하여 계속 업데이트하여 정확도를 높일 계획입니다. 앞에서 언급한대로 MobliePose-pytorch를 사용할 것입니다.

 <img src="https://user-images.githubusercontent.com/50190325/80907518-ececd480-8d52-11ea-9ba6-f0fa98eb7dc9.png" width="256px" height="256px" title="example_pose" alt="pose"></img>
 <img src="https://user-images.githubusercontent.com/50190325/80907712-27a33c80-8d54-11ea-85c5-b6895a605c4f.png" width="256px" height="256px" title="example_pose" alt="pose"></img>
 <img src="https://user-images.githubusercontent.com/50190325/80907714-2a059680-8d54-11ea-949a-f722a704d2ef.png" width="256px" height="256px" title="example_pose" alt="pose"></img>

- 카메라 센서로 인물 사진 데이터를 수집 할 수 있지만, 사생활 침해 논란 및 수집기간의 부족으로 수집하지 않도록 하였습니다. 대신 포즈 인식을 통해 인식된 인물의 관절 위치 데이터만을 json형식의 http 통신을 통해 서버에 전송하도록 할 것입니다. 전송된 데이터는 AWS DynamoDB NoSql에 전송된 각 관절 이름을 키로 위치를 값으로 가지는 json 형식으로 저장 될 예정입니다.

- 서버는 AWS Lambda를 이용한 Serverless 아키텍쳐로 구성할 예정이며, 파이썬 코드를 사용할 예정입니다. 관절 데이터를 저장하는 API와 비상연락망에 연락하는 API 두개를 개발할 예정입니다.

- 분석된 결과를 가지고 해당 카메라 위치에 넘어진 사람이 있음을 감지하여 미리 지정된 비상연락망에 연락합니다. 비상 연락망 연락 수단으로는 라인 봇, 텔레그램 봇을 이용한 메신저 알림, SMS API를 이용한 문자 알림, 이메일을 통한 이메일 알림을 모두 고려중입니다. 

# 기대성과
  
  나이가 많은 어르신들이나 거동이 불편한 환자들이 미끄러짐 또는 넘어짐으로 치명상을 입었지만 주변에 알리지 못할경우 이를 해결해 줄 수 있을것입니다.
  
  
# Teammates
  
  강동욱
  
    역할 : 서버 개발, 커미터
  
    핵심기여역량 : 서버구현, 비상연락망 연락을 위한 라인봇 텔레그렘봇 연동 구현, DB 연동, 커미터, 앱 배포 프로세스 관리

  <img src="https://user-images.githubusercontent.com/21076531/79041137-508a5300-7c28-11ea-9024-f9688c5ca3b4.jpg" width="256px" height="256px" title="강동욱" alt="강동욱"></img>
    
  오새암
  
    역할 : 머신러닝 모델 개발
    
    핵심기여역량 : 카메라인식 포즈인식(머신러닝) 모델구현, 머신러닝에 필요한 데이터 수집, 개발 일지 작성(ReadMe), 1차 기술 발표, 프로젝트 매니저(PM)
    
   <img src="https://user-images.githubusercontent.com/50190325/79058904-92f67300-7cae-11ea-8831-89778d5b0ab4.jpg" width="120px" height="160px" title="오새암" alt="오새암"></img>
    
  천명철
  
    역할 : 팀장, 클라이언트 개발
    
    핵심기여역량 : 앱 개발(시작/종료 버튼, 고유번호 설정, 라인에 입력시 알림오도록), 팀장, 온라인 미팅 주도, 프로젝트 2차 발표, 프로젝트 판넬 제작
   
  <img src="https://user-images.githubusercontent.com/50235391/79042795-aadde080-7c35-11ea-808c-2b4d18932ca3.jpg" width="110px" height="150px" title="천명철" alt="ME"></img>
    
    


# 개발환경


  개발 도구 : Node.js, keras, MobilePose-pytorch, Tensorflow-Poseestimation
  
  협업 도구 : github, Slack, Trello
  
  개발 방식 : github을 이용한 pull request 방식으로 agile 개발.  Trello를 이용한 프로젝트 관리. 
